import{$,focusApp}from'./dom.min.js';export class Router{constructor(r){this.routes=r;addEventListener('hashchange',()=>this.resolve());addEventListener('DOMContentLoaded',()=>this.resolve());}parseHash(){const raw=location.hash.replace(/^#\/?/,'');const[p,q]=raw.split('?');const query=Object.fromEntries(new URLSearchParams(q||''));return{path:'/'+(p||''),query};}async resolve(){const app=$('#app');if(!app)return;app.setAttribute('aria-busy','true');const{path,query}=this.parseHash();const route=this.routes[path]||this.routes['/404'];const{template,afterRender}=await route(query);app.innerHTML=template;app.setAttribute('aria-busy','false');typeof afterRender==='function'&&afterRender({query});const t=document.getElementById('nav-toggle');if(t)t.checked=false;focusApp();}}